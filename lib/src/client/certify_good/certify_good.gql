fragment allCertifyGoodTree on CertifyGood {
  justification
  subject {
    __typename
    ... on Package {
      type
      namespaces {
        namespace
        names {
          name
          versions {
            version
            qualifiers {
              key
              value
            }
            subpath
          }
        }
      }
    }
    ... on Source {
      type
      namespaces {
        namespace
        names {
          name
          tag
          commit
        }
      }
    }
    ... on Artifact {
      algorithm
      digest
    }
  }
  origin
  collector
}

mutation IngestCertifyGood($package: PkgInputSpec!, $origin: String!, $collector: String!, $justification: String!) {
  ingestCertifyGood(
    subject: {
      package: $package
    }
    pkgMatchType: { pkg: SPECIFIC_VERSION }
    certifyGood: {
      justification: $justification
      origin: $origin
      collector: $collector
    }
  ) {
    ...allCertifyGoodTree
  }
}

query QueryCertifyGood($package: PkgSpec) {
  CertifyGood(certifyGoodSpec: { subject: {package: $package}}) {
    ...allCertifyGoodTree
  }
}

