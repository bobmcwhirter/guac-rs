fragment allCertifyVulnTree on CertifyVuln {
    id
    package {
        id
        type
        namespaces {
            id
            namespace
            names {
                id
                name
                versions {
                    id
                    version
                    qualifiers {
                        key
                        value
                    }
                    subpath
                }
            }
        }
    }
    vulnerability {
        __typename
        ... on CVE {
            id
            year
            cveId
        }
        ... on OSV {
            id
            osvId
        }
        ... on GHSA {
            id
            ghsaId
        }
        ... on NoVuln {
            id
        }
    }
    metadata {
        dbUri
        dbVersion
        scannerUri
        scannerVersion
        timeScanned
        origin
        collector
    }
}

query CertifyVulnQ1 {
    CertifyVuln(certifyVulnSpec: {}) {
        ...allCertifyVulnTree
    }
}

mutation IngestCertifyVuln($package: PkgInputSpec!, $vulnerability: VulnerabilityInput!, $meta: VulnerabilityMetaDataInput!) {
    ingestVulnerability(
        pkg: $package
        vulnerability: $vulnerability
        certifyVuln: $meta
    )  {
        ...allCertifyVulnTree
    }
}

query QueryCertifyVulnByPackage($package: PkgSpec) {
    CertifyVuln(certifyVulnSpec: {package: $package}) {
        ...allCertifyVulnTree
    }
}

query QueryCertifyVulnByCve($cve: CVESpec) {
    CertifyVuln(certifyVulnSpec: {vulnerability: {cve: $cve}}) {
        ...allCertifyVulnTree
    }
}